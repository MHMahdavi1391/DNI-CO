<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>جزئیات محصول - DNI CO</title>
<link href="https://fonts.googleapis.com/css2?family=Vazir&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
  body { font-family: 'Vazir', sans-serif; background: #ffffff; color: #0d3b66; margin: 0; padding: 0; }

  .product-card { background: #f0f8ff; padding: 20px; border-radius: 10px; max-width: 900px; margin: 20px auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; gap: 20px; }
  .product-card img { width: 100%; border-radius: 10px; }
  .product-info { display: flex; flex-direction: column; gap: 10px; }
  .price { font-weight: bold; font-size: 1.2rem; color: #0077b6; }
  .order-form { margin-top: 15px; display: flex; flex-direction: column; gap: 10px; }
  .order-form input, .order-form textarea { padding: 10px; font-size: 1rem; border: 1px solid #0077b6; border-radius: 5px; }
  .order-form button { padding: 10px; font-size: 1rem; background: #0077b6; color: #fff; border: none; border-radius: 5px; cursor: pointer; transition: 0.2s; }
  .order-form button:hover { background: #005f8a; }

  /* لپ‌تاپ و صفحه بزرگ: دو ستون */
  @media (min-width: 900px) {
    .product-card { flex-direction: row; align-items: flex-start; }
    .product-card img { width: 50%; max-width: 400px; height: auto; object-fit: contain; order: 2; }
    .product-info { flex: 1; padding-right: 20px; order: 1; }
  }

  /* موبایل و تبلت: عکس بالای متن و فرم */
  @media (max-width: 899px) {
    .product-card { flex-direction: column; }
    .product-card img { order: 0; }
    .product-info { order: 1; }
  }
</style>
</head>
<body>

<header class="header">
  <div class="header-container">
    <h1 class="site-title">DNI CO</h1>
    <h2 class="site-subtitle">شرکت دیتک نمای ایران</h2>
  </div>
</header>

<main>
  <div id="product-detail" class="product-detail"></div>
</main>

<footer class="footer">
  <div class="footer-container">
    © کلیه حقوق متعلق به DNI CO است | تاریخ ساخت: ۱۴۰۴ | مدیر: 09362335266
    <a href="https://mhmahdavi1391.github.io/DNI-CO/n" target="_blank" style="color:#0d6efd;">شرکت در نظرسنجی و بهبود کیفیت</a>
  </div>
</footer>

<button id="back-to-top">&#8679;</button>

<script>
const params = new URLSearchParams(window.location.search);
const productId = params.get("id");

fetch("products.json")
  .then(response => response.json())
  .then(data => {
    const product = data.find(p => p.id == productId);
    const container = document.getElementById("product-detail");

    if(product){
      container.innerHTML = `
        <div class="product-card">
          <img src="${product.image}" alt="${product.name}">
          <div class="product-info">
            <h2>${product.name}</h2>
            <p class="price">${product.price} تومان</p>
            <p class="details">${product.details}</p>
            <form id="order-form" class="order-form">
              <input type="text" name="name" placeholder="نام و نام خانوادگی" required>
              <input type="text" name="phone" placeholder="شماره تلفن" required>
              <input type="text" name="address" placeholder="آدرس خریدار" required>
              <textarea name="note" placeholder="توضیحات" rows="3"></textarea>
              <button type="submit">ارسال سفارش</button>
            </form>
          </div>
        </div>
      `;

      setTimeout(() => container.style.opacity = 1, 100);

      const token = 'bot425913:7d5eec5b-c6c8-4bd9-9500-95e1d5a3bde4';
      const chat_id = 10977332;

      const form = document.getElementById('order-form');
      form.addEventListener('submit', function(e){
        e.preventDefault();
        const formData = new FormData(form);
        const name = formData.get('name');
        const phone = formData.get('phone');
        const address = formData.get('address');
        const note = formData.get('note');

        const message = `سفارش محصول:\nنام: ${name}\nشماره: ${phone}\nآدرس: ${address}\nتوضیحات: ${note || ''}\n\nمحصول: ${product.name}\nقیمت: ${product.price} تومان`;

        const url = `https://eitaayar.ir/api/${token}/sendMessage?chat_id=${chat_id}&text=${encodeURIComponent(message)}`;

        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = url;
        document.body.appendChild(iframe);

        alert("سفارش شما با موفقیت ثبت شد!");
        form.reset();
      });

    } else {
      container.innerHTML = "<p>محصول یافت نشد</p>";
    }
  })
  .catch(err => {
    document.getElementById("product-detail").innerHTML = "<p style='color:red;'>خطا در بارگذاری محصول</p>";
    console.error(err);
  });

const backToTop = document.getElementById("back-to-top");
window.addEventListener("scroll", () => {
  backToTop.style.display = window.scrollY > 300 ? "flex" : "none";
});
backToTop.addEventListener("click", () => {
  window.scrollTo({ top: 0, behavior: "smooth" });
});
</script>

</body>
</html>
